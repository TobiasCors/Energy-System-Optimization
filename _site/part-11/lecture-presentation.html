<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-48ffa3e5b9d089919c6712c39e5b00f2.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.41">

  <meta name="author" content="Dr.&nbsp;Tobias Cors">
  <title>Energy System Optimization with Julia – Lecture XI - Framework for Multi-Energy System Optimization</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-653911d01099ef05c9ae47df4de1f73b.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#025259" class="quarto-title-block center">
  <h1 class="title">Lecture XI - Framework for Multi-Energy System Optimization</h1>
  <p class="subtitle">Energy System Optimization with Julia</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Tobias Cors 
</div>
        <p class="quarto-title-affiliation">
            Hamburg University of Applied Science - Summer 2025
          </p>
    </div>
</div>

</section>
<section>
<section id="quick-recap-from-last-week" class="title-slide slide level1 title center">
<h1><span class="flow">Quick Recap from last Week</span></h1>

</section>
<section id="multi-energy-system-design-problem-overview" class="slide level2">
<h2>Multi-Energy System Design Problem Overview</h2>
<ul>
<li><p><strong>Objective</strong>: Minimize total annual costs (investment + operational) while respecting budget constraints for multi-energy systems</p></li>
<li><p><strong>Decision Variables</strong>:</p>
<ul>
<li>Investment variables (First Stage):
<ul>
<li>Storage energy capacity (<span class="math inline">\(e^{nom}_s\)</span>) for both electricity and hydrogen storage</li>
<li>Storage charging power (<span class="math inline">\(p^{ch,nom}_s\)</span>) for both energy carriers</li>
<li>Storage discharging power (<span class="math inline">\(p^{dis,nom}_s\)</span>) for both energy carriers</li>
<li>Wind park capacity (<span class="math inline">\(p^{nom}_w\)</span>)</li>
<li>PV park capacity (<span class="math inline">\(p^{nom}_v\)</span>)</li>
<li>Electrolyzer capacity (<span class="math inline">\(p^{nom}_x\)</span>)</li>
</ul></li>
<li>Operational variables (Second Stage):
<ul>
<li>Wind power output (<span class="math inline">\(p_{w,t,\omega}\)</span>)</li>
<li>PV power output (<span class="math inline">\(p_{v,t,\omega}\)</span>)</li>
<li>Grid import/export (<span class="math inline">\(p^{in}_{t,\omega}\)</span>, <span class="math inline">\(p^{out}_{t,\omega}\)</span>)</li>
<li>Storage operation (<span class="math inline">\(p^{ch}_{s,t,\omega}\)</span>, <span class="math inline">\(p^{dis}_{s,t,\omega}\)</span>, <span class="math inline">\(e_{s,t,\omega}\)</span>)</li>
<li>Electrolyzer operation (<span class="math inline">\(p_{x,t,\omega}\)</span>, <span class="math inline">\(h_{x,t,\omega}\)</span>)</li>
</ul></li>
</ul></li>
<li><p><strong>Key Constraints</strong>:</p>
<ul>
<li>Investment budget limit</li>
<li>Electricity power balance</li>
<li>Hydrogen balance</li>
<li>Component capacity limits</li>
<li>Storage energy balance</li>
<li>Storage energy limits</li>
<li>Storage power limits</li>
<li>Electrolyzer conversion constraints</li>
</ul></li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The Multi-Energy System Design problem extends the basic energy system design by incorporating multiple energy carriers (electricity and hydrogen) and energy conversion technologies (electrolyzers). The stochastic formulation considers multiple scenarios to account for uncertainty in renewable generation, demand patterns, and price variations across different energy carriers.</p>
</div>
</div>
</div>
</section>
<section id="mathematical-formulation" class="slide level2">
<h2>Mathematical Formulation</h2>
<h3 id="objective-function">Objective Function</h3>
<p><span class="math inline">\(\text{Minimize} \quad \sum_{s \in \mathcal{S}} AC^{inv}_s + \sum_{w \in \mathcal{W}} AC^{inv}_w + \sum_{v \in \mathcal{V}} AC^{inv}_v + \sum_{x \in \mathcal{X}} AC^{inv}_x + \sum_{\omega \in \Omega} \pi_{\omega} (AC^{grid,imp}_{\omega} - AR^{grid,exp}_{\omega})\)</span></p>
<h3 id="key-constraints">Key Constraints</h3>
<ol type="1">
<li><strong>Investment Budget</strong>:</li>
</ol>
<p><span class="math inline">\(\sum_{s \in \mathcal{S}} (C^{E}_s e^{nom}_s + C^{P,ch}_s p^{ch,nom}_s + C^{P,dis}_s p^{dis,nom}_s) + \sum_{w \in \mathcal{W}} C^{W}_w p^{nom}_w + \sum_{v \in \mathcal{V}} C^{PV}_v p^{nom}_v + \sum_{x \in \mathcal{X}} C^{X}_x p^{nom}_x \leq B^{max}\)</span></p>
<ol start="2" type="1">
<li><strong>Electricity Power Balance</strong>:</li>
</ol>
<p><span class="math inline">\(\sum_{w \in \mathcal{W}} p_{w,t,\omega} + \sum_{v \in \mathcal{V}} p_{v,t,\omega} + (p^{in}_{t,\omega} - p^{out}_{t,\omega}) + \sum_{s \in \mathcal{S}_{\text{El}}} (p^{dis}_{s,t,\omega} - p^{ch}_{s,t,\omega}) = \sum_{x \in \mathcal{X}} p_{x,t,\omega} \quad \forall t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<ol start="3" type="1">
<li><strong>Hydrogen Balance</strong>:</li>
</ol>
<p><span class="math inline">\(\sum_{x \in \mathcal{X}} h_{x,t,\omega} + \sum_{s \in \mathcal{S}_{\text{H2}}} (p^{dis}_{s,t,\omega} - p^{ch}_{s,t,\omega}) = d_{t,\omega} \quad \forall t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<ol start="4" type="1">
<li><strong>Component Capacity Limits</strong>:</li>
</ol>
<p><span class="math inline">\(0 \leq p_{w,t,\omega} \leq f_{w,t,\omega} p^{nom}_w \quad \forall w \in \mathcal{W}, t \in \mathcal{T}, \omega \in \Omega\)</span> <span class="math inline">\(0 \leq p_{v,t,\omega} \leq f_{v,t,\omega} p^{nom}_v \quad \forall v \in \mathcal{V}, t \in \mathcal{T}, \omega \in \Omega\)</span> <span class="math inline">\(0 \leq p^{ch}_{s,t,\omega} \leq p^{ch,nom}_s \quad \forall s \in \mathcal{S}, t \in \mathcal{T}, \omega \in \Omega\)</span> <span class="math inline">\(0 \leq p^{dis}_{s,t,\omega} \leq p^{dis,nom}_s \quad \forall s \in \mathcal{S}, t \in \mathcal{T}, \omega \in \Omega\)</span> <span class="math inline">\(DoD_s e^{nom}_s \leq e_{s,t,\omega} \leq e^{nom}_s \quad \forall s \in \mathcal{S}, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<ol start="5" type="1">
<li><strong>Storage Energy Balance</strong>:</li>
</ol>
<p><span class="math inline">\(e_{s,t,\omega} = (1-sdr_s)e_{s,t-1,\omega} + \eta^{ch}_s p^{ch}_{s,t,\omega} - \frac{p^{dis}_{s,t,\omega}}{\eta^{dis}_s} \quad \forall s \in \mathcal{S}, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<ol start="6" type="1">
<li><strong>Electrolyzer Constraints</strong>:</li>
</ol>
<p><span class="math inline">\(0 \leq p_{x,t,\omega} \leq p^{nom}_x \quad \forall x \in \mathcal{X}, t \in \mathcal{T}, \omega \in \Omega\)</span> <span class="math inline">\(h_{x,t,\omega} = \beta_x p_{x,t,\omega} \quad \forall x \in \mathcal{X}, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
</section>
<section id="model-characteristics" class="slide level2">
<h2>Model Characteristics</h2>
<ul>
<li>Two-stage stochastic Linear Programming (LP) problem for multi-energy systems</li>
<li>Combines investment and operational decisions across multiple energy carriers</li>
<li>Large-scale optimization problem with energy conversion technologies</li>
<li>Requires efficient solution methods</li>
<li>Considers multiple scenarios for robust decision-making</li>
<li>Integrates electricity and hydrogen value chains</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>The multi-energy system model can be adapted to specific use cases, i.e., if certain components already have fixed capacities, the corresponding variables can be converted to parameters. The stochastic formulation allows for more robust investment decisions by considering multiple scenarios across different energy carriers.</p>
</div>
</div>
</div>
</section>
<section id="key-extensions-from-single-energy-systems" class="slide level2">
<h2>Key Extensions from Single-Energy Systems</h2>
<h3 id="new-components">New Components</h3>
<ul>
<li><strong>Electrolyzers</strong>: Convert electricity to hydrogen with efficiency <span class="math inline">\(\beta_x\)</span></li>
<li><strong>Hydrogen Storage</strong>: Separate storage systems for hydrogen with different characteristics</li>
<li><strong>Energy Conversion</strong>: Explicit modeling of energy carrier conversion processes</li>
</ul>
<h3 id="new-constraints">New Constraints</h3>
<ul>
<li><strong>Hydrogen Balance</strong>: Ensures hydrogen demand is met through production and storage</li>
<li><strong>Electrolyzer Operation</strong>: Links electricity consumption to hydrogen production</li>
<li><strong>Multi-Carrier Storage</strong>: Distinguishes between electricity (<span class="math inline">\(\mathcal{S}_{\text{El}}\)</span>) and hydrogen (<span class="math inline">\(\mathcal{S}_{\text{H2}}\)</span>) storage</li>
</ul>
<h3 id="modified-constraints">Modified Constraints</h3>
<ul>
<li><strong>Electricity Balance</strong>: Now includes electrolyzer consumption instead of direct demand</li>
<li><strong>Investment Budget</strong>: Includes electrolyzer investment costs</li>
<li><strong>Objective Function</strong>: Includes electrolyzer annualized investment costs</li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>These extensions enable comprehensive optimization of energy value chains, allowing for optimal sizing and operation of systems that convert between the different energy carriers while considering uncertainty and operational constraints.</p>
</div>
</div>
</div>
</section>
<section id="solutions-from-last-week" class="slide level2">
<h2>Solutions from last Week</h2>
<ul>
<li>The tutorials from last week will again be <span class="highlight">available on Friday</span></li>
<li>You can access them in the project folder on Github</li>
<li>Click on the little cat icon on the bottom right</li>
</ul>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p><span class="highlight">You can ask questions anytime in class or via email!</span></p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="excursion-big-m-constraints-in-mixed-integer-programming" class="title-slide slide level1 title center">
<h1><span class="flow">Excursion: Big M Constraints in Mixed-Integer Programming</span></h1>

</section>
<section id="what-are-big-m-constraints" class="slide level2">
<h2>What are Big M Constraints?</h2>
<p>Big M constraints are a fundamental modeling technique in Mixed-Integer Linear Programming (MILP) used to create conditional relationships between continuous and binary variables. The “M” represents a large constant that acts as an upper bound, allowing constraints to be “turned on” or “turned off” based on binary variable values.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Big M constraints enable the modeling of complex logical relationships and conditional constraints that would otherwise be difficult to express in linear programming formulations.</p>
</div>
</div>
</div>
</section>
<section id="basic-concept" class="slide level2">
<h2>Basic Concept</h2>
<p>The general form of a big M constraint is:</p>
<p><span class="math inline">\(f(x) \leq M (1 - y)\)</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(f(x)\)</span> is a function of continuous variables</li>
<li><span class="math inline">\(M\)</span> is a large constant (the “big M”)</li>
<li><span class="math inline">\(y\)</span> is a binary variable (0 or 1)</li>
</ul>
<p><strong>Logic</strong>: When <span class="math inline">\(y = 1\)</span>, the constraint becomes <span class="math inline">\(f(x) \leq 0\)</span> (active). When <span class="math inline">\(y = 0\)</span>, the constraint becomes <span class="math inline">\(f(x) \leq M\)</span> (inactive, since <span class="math inline">\(M\)</span> is large).</p>
</section>
<section id="example-from-unit-commitment-startup-timing-constraints" class="slide level2">
<h2>Example from Unit Commitment: Startup Timing Constraints</h2>
<p>Consider the constraint from the intermission lecture where generator 3 and generator 4 cannot start up within 3 time periods of each other:</p>
<p><span class="math inline">\(\sum_{\tau \in [t, \min(t+3,|\mathcal{T}|)]} v_{3,\tau} \leq (1 - v_{4,t}) M \quad \forall t \in \mathcal{T}\)</span></p>
<p><span class="math inline">\(\sum_{\tau \in [t-1, \max(t-3,1)]} v_{3,\tau} \leq (1 - v_{4,t}) M \quad \forall t \in \mathcal{T}\)</span></p>
<h3 id="how-it-works">How it Works:</h3>
<ol type="1">
<li><strong>When <span class="math inline">\(v_{4,t} = 1\)</span></strong> (generator 4 starts at time <span class="math inline">\(t\)</span>):
<ul>
<li>The right-hand side becomes <span class="math inline">\((1-1) M = 0\)</span></li>
<li>The constraint forces <span class="math inline">\(\sum v_{3,\tau} \leq 0\)</span></li>
<li>This means generator 3 cannot start in the specified time windows</li>
</ul></li>
<li><strong>When <span class="math inline">\(v_{4,t} = 0\)</span></strong> (generator 4 does not start at time <span class="math inline">\(t\)</span>):
<ul>
<li>The right-hand side becomes <span class="math inline">\((1-0) M = M\)</span></li>
<li>The constraint becomes <span class="math inline">\(\sum v_{3,\tau} \leq M\)</span></li>
<li>Since <span class="math inline">\(M\)</span> is large, this constraint is effectively not limiting the startup of generator 3 and hence not active</li>
</ul></li>
</ol>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>The choice of <span class="math inline">\(M\)</span> is crucial: it must be large enough to make constraints inactive when needed, but not so large that it causes numerical issues in the solver.</p>
</div>
</div>
</div>
</section>
<section id="choosing-the-right-big-m-value" class="slide level2">
<h2>Choosing the Right Big M Value</h2>
<h3 id="guidelines-for-selecting-m">Guidelines for Selecting M:</h3>
<ol type="1">
<li><strong>Upper Bound</strong>: <span class="math inline">\(M\)</span> should be an upper bound on the left-hand side expression</li>
<li><strong>Tightness</strong>: Choose the smallest possible value that still works</li>
<li><strong>Numerical Stability</strong>: Avoid extremely large values that can cause solver issues</li>
</ol>
<h3 id="example-calculation">Example Calculation:</h3>
<p>For the startup timing constraint, a good choice for <span class="math inline">\(M\)</span> would be:</p>
<ul>
<li><span class="math inline">\(M = |\mathcal{T}|\)</span> (total number of time periods)</li>
<li>This ensures that even if all startup variables were 1, the constraint would still be satisfied when inactive</li>
<li>Considering that the fastest startup variable sequence is 1-0-1-0-…, M could be set to 2 here.</li>
</ul>
</section>
<section id="advantages-and-disadvantages" class="slide level2">
<h2>Advantages and Disadvantages</h2>
<h3 id="advantages">Advantages:</h3>
<ul>
<li><strong>Flexibility</strong>: Enables modeling of complex logical relationships</li>
<li><strong>Linear Formulation</strong>: Maintains linearity of the optimization problem</li>
<li><strong>Wide Applicability</strong>: Can be used in many different contexts</li>
</ul>
<h3 id="disadvantages">Disadvantages:</h3>
<ul>
<li><strong>Numerical Issues</strong>: Poor choice of <span class="math inline">\(M\)</span> can cause solver difficulties</li>
<li><strong>Weak Relaxation</strong>: Can lead to weak linear programming relaxations</li>
<li><strong>Solution Quality</strong>: May result in slower convergence</li>
</ul>
</section>
<section id="alternative-approaches" class="slide level2">
<h2>Alternative Approaches</h2>
<h3 id="indicator-constraints">1. Indicator Constraints</h3>
<p>Indicator constraints replace big M constraints with direct logical relationships. They are best suited for <strong>simple binary conditions</strong> where you have clear “if-then” relationships.</p>
<p><strong>Big M approach:</strong></p>
<p><span class="math inline">\(p_g \leq p_g^{max} u_g\)</span></p>
<p><strong>Indicator constraint approach:</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a></a><span class="pp">@constraint</span>(model, u_g <span class="op">=&gt;</span> {p_g <span class="op">&lt;=</span> p_g_max})  <span class="co"># If generator is ON, then power ≤ max</span></span>
<span id="cb1-2"><a></a><span class="pp">@constraint</span>(model, !u_g <span class="op">=&gt;</span> {p_g <span class="op">==</span> <span class="fl">0</span>})       <span class="co"># If generator is OFF, then power = 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>When to use</strong>: Simple binary logic (on/off, yes/no, active/inactive)</p>
<p><strong>Key characteristic</strong>: Direct logical statements without mutual exclusivity requirements</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>No need to choose M values</li>
<li>Often leads to tighter formulations</li>
<li>More intuitive modeling</li>
<li>Better numerical stability</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Not all solvers support indicator constraints</li>
<li>May require specialized solvers</li>
</ul>
<h3 id="disjunctive-programming">2. Disjunctive Programming</h3>
<p>Disjunctive programming handles <strong>complex multi-state conditions</strong> where exactly one state must be active. It uses special ordered sets (SOS1) to enforce mutual exclusivity.</p>
<p><strong>Example</strong>: A generator can operate in exactly one of three modes: off, minimum load, or full load.</p>
<p><strong>Big M approach:</strong></p>
<p><span class="math inline">\(p_g \leq (1 - u_g^{off}) + p_g^{min} u_g^{min} + p_g^{max} u_g^{max}\)</span></p>
<p><span class="math inline">\(p_g \geq (1 - u_g^{off}) + p_g^{min} u_g^{min} + p_g^{max} u_g^{max}\)</span></p>
<p><span class="math inline">\(u_g^{off} + u_g^{min} + u_g^{max} \leq 1\)</span></p>
<p><strong>Disjunctive approach:</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a></a><span class="co"># SOS1 ensures exactly one binary variable is 1, others are 0</span></span>
<span id="cb2-2"><a></a><span class="pp">@constraint</span>(model, [u_g_off, u_g_min, u_g_max] <span class="kw">in</span> MOI.<span class="fu">SOS1</span>(<span class="fl">3</span>))</span>
<span id="cb2-3"><a></a><span class="pp">@constraint</span>(model, u_g_off <span class="op">=&gt;</span> {p_g <span class="op">==</span> <span class="fl">0</span>})                       <span class="co"># State 1: Off</span></span>
<span id="cb2-4"><a></a><span class="pp">@constraint</span>(model, u_g_min <span class="op">=&gt;</span> {p_g <span class="op">==</span> p_g_min})                 <span class="co"># State 2: Minimum load</span></span>
<span id="cb2-5"><a></a><span class="pp">@constraint</span>(model, u_g_max <span class="op">=&gt;</span> {p_g <span class="op">==</span> p_g_max})                 <span class="co"># State 3: Full load</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>When to use</strong>: Multiple mutually exclusive states or operational modes <strong>Key characteristic</strong>: Enforces that exactly one state is active at a time</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>More structured for complex logical relationships</li>
<li>Can lead to better formulations</li>
<li>Easier to understand complex constraints</li>
<li>Enforces mutual exclusivity automatically</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>More complex implementation</li>
<li>May not be supported by all solvers</li>
</ul>
<h3 id="key-differences-between-approaches-1-and-2">Key Differences Between Approaches 1 and 2:</h3>
<table class="caption-top">
<colgroup>
<col style="width: 14%">
<col style="width: 40%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>Indicator Constraints</th>
<th>Disjunctive Programming</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Complexity</strong></td>
<td>Simple binary logic</td>
<td>Multiple states</td>
</tr>
<tr class="even">
<td><strong>Mutual Exclusivity</strong></td>
<td>Not enforced</td>
<td>Automatically enforced</td>
</tr>
<tr class="odd">
<td><strong>Use Case</strong></td>
<td>“If A, then B”</td>
<td>“Must be in exactly one of states A, B, C”</td>
</tr>
<tr class="even">
<td><strong>Implementation</strong></td>
<td>Direct logical statements</td>
<td>SOS1 constraints</td>
</tr>
<tr class="odd">
<td><strong>Example</strong></td>
<td>Generator on/off</td>
<td>Generator off/min/max modes</td>
</tr>
</tbody>
</table>
<h3 id="reformulation">3. Reformulation</h3>
<p>Sometimes big M constraints can be reformulated using additional variables or constraints that are more efficient or numerically stable.</p>
<p><strong>Example</strong>: Instead of using big M for minimum up time constraints, use a different approach.</p>
<p><strong>Big M approach:</strong></p>
<p><span class="math inline">\(\sum_{t'=t}^{t+T^{min}-1} u_{g,t'} \geq T^{min} v_{g,t}\)</span></p>
<p><strong>Reformulation approach:</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a></a><span class="co"># Use a continuous variable to track remaining minimum up time</span></span>
<span id="cb3-2"><a></a><span class="pp">@variable</span>(model, <span class="fl">0</span> <span class="op">&lt;=</span> remaining_up_time[g, t] <span class="op">&lt;=</span> T_min)</span>
<span id="cb3-3"><a></a><span class="pp">@constraint</span>(model, remaining_up_time[g, t] <span class="op">&lt;=</span> T_min <span class="op">*</span> u_g[t])</span>
<span id="cb3-4"><a></a><span class="pp">@constraint</span>(model, remaining_up_time[g, t] <span class="op">&lt;=</span> remaining_up_time[g, t<span class="op">-</span><span class="fl">1</span>] <span class="op">-</span> <span class="fl">1</span> <span class="op">+</span> T_min <span class="op">*</span> v_g[t])</span>
<span id="cb3-5"><a></a><span class="pp">@constraint</span>(model, remaining_up_time[g, t] <span class="op">&gt;=</span> <span class="fl">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Advantages:</strong></p>
<ul>
<li>Often more numerically stable</li>
<li>Can provide tighter formulations</li>
<li>May lead to faster solution times</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>More complex to implement</li>
<li>Requires more variables and constraints</li>
<li>May not always be possible</li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Big M constraints are a powerful tool in MILP modeling, but they should be used carefully with appropriate values for <span class="math inline">\(M\)</span> to ensure both correctness and computational efficiency.</p>
</div>
</div>
</div>
</section>
<section id="practical-tips" class="slide level2">
<h2>Practical Tips</h2>
<ol type="1">
<li><strong>Document your choice of M</strong>: Always explain why you chose a particular value</li>
<li><strong>Test with small instances</strong>: Verify that your constraints work as expected</li>
<li><strong>Consider solver-specific features</strong>: Some solvers have built-in support for certain constraint types</li>
<li><strong>Monitor solution times</strong>: If the problem is slow to solve, consider if big M constraints are the bottleneck</li>
</ol>
</section></section>
<section>
<section id="recap-introduction-to-multi-energy-systems" class="title-slide slide level1 title center">
<h1><span class="flow">Recap: Introduction to Multi-Energy Systems</span></h1>

</section>
<section id="multi-energy-systems-definition" class="slide level2">
<h2>Multi-Energy Systems: Definition</h2>
<p>A multi-energy system is a system that combines multiple energy carriers (e.g.&nbsp;electricity, hydrogen, heat, etc.) to meet the energy demand of a specific application.</p>
</section>
<section id="multi-energy-systems-example-hydrogen-value-chain" class="slide level2">
<h2>Multi-Energy Systems: Example Hydrogen Value Chain</h2>

<img data-src="H2-mes.png" style="width:70.0%" class="r-stretch quarto-figure-center"><p class="caption">Example case of a hydrogen value chain</p><div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The figure shows a multi-energy system with:</p>
<ul>
<li>Renewable energy sources (PV and Wind) and grid connection</li>
<li>Electric bus bar for power distribution</li>
<li>Electrolyzer for hydrogen production</li>
<li>Hydrogen bus bar for hydrogen distribution</li>
<li>Hydrogen storage</li>
<li>Hydrogen demand</li>
</ul>
</div>
</div>
</div>
</section>
<section id="framework-for-multi-energy-system-design-problem" class="slide level2">
<h2>Framework for Multi-Energy System Design Problem</h2>
<p>In this lecture, we reformulate the Stochastic Multi-Energy System Design problem to be applicable to a wide range of energy system applications <em>only by changing the sets and parameters</em>. This allows us to:</p>
<ol type="1">
<li>Adapt the model to the specific energy system application by changing the sets and parameters</li>
<li>Optimize technology selection over the entire energy value chain</li>
<li>Determine optimal component sizes</li>
<li>Balance investment and operational costs</li>
<li>Plan local multi-energy systems holistically (e.g.&nbsp;electricity, hydrogen, heat, etc.)</li>
</ol>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Remember: The design problem combines investment planning (sizing) with operational optimization, enabling comprehensive (multi-)energy system design.</p>
</div>
</div>
</div>
</section></section>
<section>
<section id="mathematical-formulation-of-the-general-multi-energy-system-framework" class="title-slide slide level1 title center">
<h1><span class="flow">Mathematical Formulation of the General Multi-Energy System Framework</span></h1>
<p><strong>… extending the stochastic design problem to a general multi-energy system framework</strong></p>
</section>
<section id="sets" class="slide level2">
<h2>Sets</h2>
<ul>
<li><span class="math inline">\(\mathcal{T}\)</span> - Set of time periods indexed by <span class="math inline">\(t \in \{1,2,...,|\mathcal{T}|\}\)</span></li>
<li><span class="math inline">\(\mathcal{E}\)</span> - Set of energy carriers/fuels indexed by <span class="math inline">\(e \in \{1,2,...,|\mathcal{E}|\}\)</span></li>
<li><span class="math inline">\(\mathcal{E}^D\)</span> - Subset of energy carriers associated with demand constraints</li>
<li><span class="math inline">\(\mathcal{G}\)</span> - Set of dispatchable technology units indexed by <span class="math inline">\(g \in \{1,2,...,|\mathcal{G}|\}\)</span></li>
<li><span class="math inline">\(\mathcal{G}^S\)</span> - Subset of storage technology units</li>
<li><span class="math inline">\(\mathcal{G}^{UC}\)</span> - Subset of technology units with unit commitment constraints</li>
<li><span class="math inline">\(\mathcal{G}^{Var}\)</span> - Subset of variable energy technology units (e.g., wind, solar)</li>
<li><span class="math inline">\(\mathcal{G}^R\)</span> - Subset of technology units with ramping constraints</li>
<li><span class="math inline">\(\mathcal{E}_g^{In}\)</span> - Mapping set of feedstock fuels to technology <span class="math inline">\(g\)</span></li>
<li><span class="math inline">\(\mathcal{E}_g^{Out}\)</span> - Mapping set of produced fuels from technology <span class="math inline">\(g\)</span></li>
<li><span class="math inline">\(\Omega\)</span> - Set of scenarios indexed by <span class="math inline">\(\omega \in \{1,2,...,|\Omega|\}\)</span></li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The general framework uses technology-agnostic sets that can represent any energy conversion technology (electrolyzers, fuel cells, heat pumps, etc.) and any energy carrier (electricity, hydrogen, heat, natural gas, etc.).</p>
</div>
</div>
</div>
</section>
<section id="decision-variables" class="slide level2">
<h2>Decision Variables</h2>
<h3 id="investment-variables-first-stage">Investment Variables (First Stage)</h3>
<ul>
<li><span class="math inline">\(P_g^{nom}\)</span> - Nominal capacity of technology <span class="math inline">\(g\)</span> [MW or appropriate unit]</li>
<li><span class="math inline">\(SOC_g^{nom}\)</span> - Nominal energy capacity of storage technology <span class="math inline">\(g\)</span> [MWh or appropriate unit]</li>
</ul>
<h3 id="operational-variables-second-stage">Operational Variables (Second Stage)</h3>
<ul>
<li><span class="math inline">\(x_{g,e,t,\omega}^{in}\)</span> - Amount of feedstock fuel <span class="math inline">\(e\)</span> consumed in technology <span class="math inline">\(g\)</span> at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
<li><span class="math inline">\(x_{g,e,t,\omega}^{out}\)</span> - Amount of produced fuel <span class="math inline">\(e\)</span> from technology <span class="math inline">\(g\)</span> at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
<li><span class="math inline">\(x_{g,t,\omega}^{total}\)</span> - Total activity level of technology <span class="math inline">\(g\)</span> at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
<li><span class="math inline">\(f_{e,t,\omega}^{buy}\)</span> - Flow of fuel <span class="math inline">\(e\)</span> bought at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
<li><span class="math inline">\(f_{e,t,\omega}^{sell}\)</span> - Flow of fuel <span class="math inline">\(e\)</span> sold at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
<li><span class="math inline">\(soc_{g,t,\omega}\)</span> - State of charge of storage technology <span class="math inline">\(g\)</span> at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
</ul>
<h3 id="binary-variables-for-unit-commitment">Binary Variables (for Unit Commitment)</h3>
<ul>
<li><span class="math inline">\(u_{g,t,\omega}\)</span> - Binary indicating online/offline status of technology <span class="math inline">\(g\)</span> at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
<li><span class="math inline">\(v_{g,t,\omega}\)</span> - Binary indicating startup of technology <span class="math inline">\(g\)</span> at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
<li><span class="math inline">\(o_{g,t,\omega}\)</span> - Binary indicating charging/discharging status of storage technology <span class="math inline">\(g\)</span> at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
</ul>
<h3 id="cost-variables">Cost Variables</h3>
<ul>
<li><span class="math inline">\(AC_g^{inv}\)</span> - Annual investment cost for technology <span class="math inline">\(g\)</span> [EUR/year]</li>
<li><span class="math inline">\(c_{g,t,\omega}^{start}\)</span> - Startup cost of technology <span class="math inline">\(g\)</span> at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
</ul>
</section>
<section id="parameters" class="slide level2">
<h2>Parameters</h2>
<h3 id="investment-costs-first-stage">Investment Costs (First Stage)</h3>
<ul>
<li><span class="math inline">\(C_g^{inv}\)</span> - Investment cost per unit capacity for technology <span class="math inline">\(g\)</span> [EUR/MW or appropriate unit]</li>
<li><span class="math inline">\(C_g^{SOC}\)</span> - Investment cost per unit energy capacity for storage technology <span class="math inline">\(g\)</span> [EUR/MWh or appropriate unit]</li>
<li><span class="math inline">\(F^{PVAF}\)</span> - Present value annuity factor for investment costs</li>
<li><span class="math inline">\(B^{max}\)</span> - Maximum investment budget [EUR]</li>
</ul>
<h3 id="operational-parameters-second-stage">Operational Parameters (Second Stage)</h3>
<ul>
<li><span class="math inline">\(\sigma_{g,e}^{in}\)</span> - Percentage of fuel <span class="math inline">\(e\)</span> used as feedstock in technology <span class="math inline">\(g\)</span></li>
<li><span class="math inline">\(\sigma_{g,e}^{out}\)</span> - Percentage of fuel <span class="math inline">\(e\)</span> produced by technology <span class="math inline">\(g\)</span></li>
<li><span class="math inline">\(\Theta_g\)</span> - Conversion efficiency ratio of technology <span class="math inline">\(g\)</span> (output/input ratio)</li>
<li><span class="math inline">\(C_g^{var}\)</span> - Variable operating cost of technology <span class="math inline">\(g\)</span> [EUR/unit]</li>
<li><span class="math inline">\(C_g^{start}\)</span> - Startup cost of technology <span class="math inline">\(g\)</span> [EUR]</li>
<li><span class="math inline">\(D_{e,t,\omega}\)</span> - Demand of energy carrier <span class="math inline">\(e\)</span> at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
<li><span class="math inline">\(P_g^{max}\)</span> - Maximum production level of technology <span class="math inline">\(g\)</span></li>
<li><span class="math inline">\(P_g^{min}\)</span> - Minimum production level of technology <span class="math inline">\(g\)</span></li>
<li><span class="math inline">\(\pi_{e,t,\omega}^{buy}\)</span> - Price of fuel <span class="math inline">\(e\)</span> bought at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
<li><span class="math inline">\(\pi_{e,t,\omega}^{sell}\)</span> - Price of fuel <span class="math inline">\(e\)</span> sold at time <span class="math inline">\(t\)</span> in scenario <span class="math inline">\(\omega\)</span></li>
<li><span class="math inline">\(SOC_g^{init}\)</span> - Initial state of charge of storage technology <span class="math inline">\(g\)</span></li>
<li><span class="math inline">\(SOC_g^{max}\)</span> - Maximum state of charge of storage technology <span class="math inline">\(g\)</span></li>
<li><span class="math inline">\(\pi_{\omega}^{prob}\)</span> - Probability of scenario <span class="math inline">\(\omega\)</span></li>
</ul>
</section>
<section id="objective-function-1" class="slide level2">
<h2>Objective Function</h2>
<!-- 
$\text{Maximize} \quad \sum_{\omega \in \Omega} \pi_{\omega}^{prob} \left( \sum_{e \in \mathcal{E}} \sum_{t \in \mathcal{T}} \pi_{e,t,\omega}^{sell} f_{e,t,\omega}^{sell} \right.$

$\left. - \sum_{e \in \mathcal{E}} \sum_{t \in \mathcal{T}} \pi_{e,t,\omega}^{buy} f_{e,t,\omega}^{buy} - \sum_{g \in \mathcal{G}} \sum_{t \in \mathcal{T}} C_g^{var} x_{g,t,\omega}^{total} \right.$

$\left. - \sum_{g \in \mathcal{G}^{UC}} \sum_{t \in \mathcal{T}} c_{g,t,\omega}^{start} \right) - \sum_{g \in \mathcal{G}} AC_g^{inv}$ -->
<p><strong>Maximize the following components:</strong></p>
<p><span class="math inline">\(\text{Maximize}\)</span></p>
<p><strong>Revenue from selling energy carriers:</strong></p>
<p><span class="math inline">\(\sum_{\omega \in \Omega} \pi_{\omega}^{prob} \sum_{e \in \mathcal{E}} \sum_{t \in \mathcal{T}} \pi_{e,t,\omega}^{sell} f_{e,t,\omega}^{sell}\)</span></p>
<p><strong>Costs of buying energy carriers:</strong></p>
<p><span class="math inline">\(-\sum_{\omega \in \Omega} \pi_{\omega}^{prob} \sum_{e \in \mathcal{E}} \sum_{t \in \mathcal{T}} \pi_{e,t,\omega}^{buy} f_{e,t,\omega}^{buy}\)</span></p>
<p><strong>Variable operating costs:</strong></p>
<p><span class="math inline">\(-\sum_{\omega \in \Omega} \pi_{\omega}^{prob} \sum_{g \in \mathcal{G}} \sum_{t \in \mathcal{T}} C_g^{var} x_{g,t,\omega}^{total}\)</span></p>
<p><strong>Startup costs:</strong></p>
<p><span class="math inline">\(-\sum_{\omega \in \Omega} \pi_{\omega}^{prob} \sum_{g \in \mathcal{G}^{UC}} \sum_{t \in \mathcal{T}} c_{g,t,\omega}^{start}\)</span></p>
<p><strong>Investment costs:</strong></p>
<p><span class="math inline">\(-\sum_{g \in \mathcal{G}} AC_g^{inv}\)</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The objective maximizes profit: revenue from selling energy carriers minus costs of buying energy carriers, variable operating costs, startup costs, and investment costs.</p>
</div>
</div>
</div>
</section>
<section id="investment-cost-constraints" class="slide level2">
<h2>Investment Cost Constraints</h2>
<p><span class="math inline">\(AC_g^{inv} = \frac{C_g^{inv}}{F^{PVAF}} P_g^{nom} \quad \forall g \in \mathcal{G} \setminus \mathcal{G}^S\)</span></p>
<p><span class="math inline">\(AC_g^{inv} = \frac{C_g^{inv}}{F^{PVAF}} P_g^{nom} + \frac{C_g^{SOC}}{F^{PVAF}} SOC_g^{nom} \quad \forall g \in \mathcal{G}^S\)</span></p>
<h3 id="investment-budget">Investment Budget</h3>
<p><span class="math inline">\(\sum_{g \in \mathcal{G}} AC_g^{inv} \leq B^{max}\)</span></p>
</section>
<section id="energy-conversion-constraints" class="slide level2">
<h2>Energy Conversion Constraints</h2>
<h3 id="input-output-relationships">Input-Output Relationships</h3>
<p><span class="math inline">\(x_{g,e,t,\omega}^{in} = \sigma_{g,e}^{in} x_{g,t,\omega}^{total} \quad \forall g \in \mathcal{G}, e \in \mathcal{E}_g^{In}, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<p><span class="math inline">\(x_{g,e,t,\omega}^{out} = \sigma_{g,e}^{out} \Theta_g x_{g,t,\omega}^{total} \quad \forall g \in \mathcal{G} \setminus \mathcal{G}^S, e \in \mathcal{E}_g^{Out}, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<h3 id="technology-capacity-limits">Technology Capacity Limits</h3>
<p><span class="math inline">\(P_g^{min} u_{g,t,\omega} \leq x_{g,t,\omega}^{total} \leq P_g^{max} u_{g,t,\omega} \quad \forall g \in \mathcal{G} \setminus \mathcal{G}^S, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<h3 id="variable-energy-technologies">Variable Energy Technologies</h3>
<p><span class="math inline">\(0 \leq x_{g,t,\omega}^{total} \leq f_{g,t,\omega} P_g^{nom} \quad \forall g \in \mathcal{G}^{Var}, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<p>where <span class="math inline">\(f_{g,t,\omega}\)</span> is the capacity factor for variable technology <span class="math inline">\(g\)</span>.</p>
</section>
<section id="storage-constraints" class="slide level2">
<h2>Storage Constraints</h2>
<h3 id="state-of-charge-balance">State of Charge Balance</h3>
<p><span class="math inline">\(soc_{g,t,\omega} = soc_{g,t-1,\omega} + \Theta_g x_{g,t,\omega}^{total} - \sum_{e \in \mathcal{E}_g^{Out}} \sigma_{g,e}^{out} x_{g,e,t,\omega}^{out} \quad \forall g \in \mathcal{G}^S, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<h3 id="storage-capacity-limits">Storage Capacity Limits</h3>
<p><span class="math inline">\(0 \leq soc_{g,t,\omega} \leq SOC_g^{max} \quad \forall g \in \mathcal{G}^S, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<h3 id="initial-and-final-state">Initial and Final State</h3>
<p><span class="math inline">\(soc_{g,t=0,\omega} = soc_{g,t=|\mathcal{T}|,\omega} = SOC_g^{init} \quad \forall g \in \mathcal{G}^S, \omega \in \Omega\)</span></p>
<h3 id="chargingdischarging-mutual-exclusion">Charging/Discharging Mutual Exclusion</h3>
<p><span class="math inline">\(P_g^{min} o_{g,t,\omega} \leq x_{g,t,\omega}^{total} \leq P_g^{max} o_{g,t,\omega} \quad \forall g \in \mathcal{G}^S, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<p><span class="math inline">\(P_g^{min} (1-o_{g,t,\omega}) \leq \sum_{e \in \mathcal{E}_g^{Out}} \sigma_{g,e}^{out} x_{g,e,t,\omega}^{out} \leq P_g^{max} (1-o_{g,t,\omega}) \quad \forall g \in \mathcal{G}^S, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
</section>
<section id="energy-balance-constraints" class="slide level2">
<h2>Energy Balance Constraints</h2>
<h3 id="energy-carrier-balance">Energy Carrier Balance</h3>
<p><span class="math inline">\(\sum_{g \in \mathcal{G}} x_{g,e,t,\omega}^{out} + f_{e,t,\omega}^{buy} = \sum_{g \in \mathcal{G}} x_{g,e,t,\omega}^{in} + f_{e,t,\omega}^{sell} + D_{e,t,\omega} \quad \forall e \in \mathcal{E}^D, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
</section>
<section id="unit-commitment-constraints-if-applicable" class="slide level2">
<h2>Unit Commitment Constraints (if applicable)</h2>
<h3 id="startup-variable-definition">Startup Variable Definition</h3>
<p><span class="math inline">\(v_{g,t,\omega} \geq u_{g,t,\omega} - u_{g,t-1,\omega} \quad \forall g \in \mathcal{G}^{UC}, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<h3 id="startup-cost">Startup Cost</h3>
<p><span class="math inline">\(c_{g,t,\omega}^{start} \geq C_g^{start} v_{g,t,\omega} \quad \forall g \in \mathcal{G}^{UC}, t \in \mathcal{T}, \omega \in \Omega\)</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>This general framework can be specialized to specific applications by:</p>
<ol type="1">
<li>Defining appropriate energy carriers in <span class="math inline">\(\mathcal{E}\)</span></li>
<li>Specifying technology types in <span class="math inline">\(\mathcal{G}\)</span></li>
<li>Setting conversion parameters <span class="math inline">\(\sigma_{g,e}^{in}\)</span>, <span class="math inline">\(\sigma_{g,e}^{out}\)</span>, and <span class="math inline">\(\Theta_g\)</span></li>
<li>Adding application-specific constraints as needed</li>
</ol>
</div>
</div>
</div>
<div class="loud-slide">
<div class="r-fit-text">
<p>Questions?</p>
</div>
</div>
<div class="footer">

</div>
</section></section>
<section>
<section id="literature" class="title-slide slide level1 title center">
<h1><span class="flow">Literature</span></h1>

</section>
<section id="literature-i" class="slide level2">
<h2>Literature I</h2>
<p>For more interesting literature to learn more about Julia, take a look at the <a href="../general/literature.html">literature list</a> of this course.</p>
</section>
<section id="literature-ii" class="slide level2">
<h2>Literature II</h2>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>Lecture XI - Framework for Multi-Energy System Optimization | Dr.&nbsp;Tobias Cors | <a href="lecture-mes.qmd">Home</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'fast',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/TobiasCors\.github\.io\/Energy-System-Optimization");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>